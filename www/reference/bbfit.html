<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Batchwise Backfitting — opt_bbfit • bamlss</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Batchwise Backfitting — opt_bbfit" />
<meta property="og:description" content="Batchwise backfitting estimation engine for GAMLSS using very large data sets." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bamlss</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bamlss.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/terms.html">Available Model Terms</a>
    </li>
    <li>
      <a href="../articles/families.html">Families</a>
    </li>
    <li>
      <a href="../articles/bf.html">BAMLSS Model Frame</a>
    </li>
    <li>
      <a href="../articles/engines.html">Estimation Engines</a>
    </li>
    <li>
      <a href="../articles/distregvis.html">Visualization with distreg.vis</a>
    </li>
    <li>
      <a href="../articles/glm.html">Generalized Linear Models (+)</a>
    </li>
    <li>
      <a href="../articles/multinomial.html">Bayesian Multinomial Regression</a>
    </li>
    <li>
      <a href="../articles/rent.html">Munich Rent Example</a>
    </li>
    <li>
      <a href="../articles/zn.html">Spatial Location-Scale Model</a>
    </li>
    <li>
      <a href="../articles/fatalities.html">Fatalities Model for Austria</a>
    </li>
    <li>
      <a href="../articles/misc.html">Miscellaneous Topics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Publications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/jm.html">Bayesian Joint Models for Longitudinal and Survival Data</a>
    </li>
    <li>
      <a href="../articles/bivnorm.html">Bivariate Gaussian Models for Wind Vectors</a>
    </li>
    <li>
      <a href="../articles/cox.html">Complex Space-Time Interactions in a Cox Model</a>
    </li>
    <li>
      <a href="../articles/lasso.html">LASSO-Type Penalization in the Framework of GAMLSS</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Batchwise Backfitting</h1>
    
    <div class="hidden name"><code>bbfit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Batchwise backfitting estimation engine for GAMLSS using very large data sets.</p>
    </div>

    <pre class="usage"><span class='co'>## Batchwise backfitting engine.</span>
<span class='fu'>opt_bbfit</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='no'>family</span>, <span class='kw'>shuffle</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>start</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>epochs</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nbatch</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='fu'>bbfit</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='no'>family</span>, <span class='kw'>shuffle</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>start</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>epochs</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nbatch</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='co'>## Parallel version.</span>
<span class='fu'>opt_bbfitp</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='no'>family</span>, <span class='kw'>mc.cores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>...</span>)

<span class='co'>## Loglik contribution plot.</span>
<span class='fu'>contribplot</span>(<span class='no'>x</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>For function <code><a href='bfit.html'>bfit()</a></code> the <code>x</code> list, as returned from function
    <code><a href='bamlss.frame.html'>bamlss.frame</a></code>, holding all model matrices and other information that is used for
    fitting the model. For the updating functions an object as returned from function
    <code><a href='https://www.rdocumentation.org/packages/mgcv/topics/smooth.construct'>smooth.construct</a></code> or <code><a href='https://www.rdocumentation.org/packages/mgcv/topics/smoothCon'>smoothCon</a></code>. For function
    <code>contribplot()</code>, a <code>"bamlss"</code> object using <code>bbfit()</code> with argument
    <code>select = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>The model response, as returned from function <code><a href='bamlss.frame.html'>bamlss.frame</a></code>.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>A <span class="pkg">bamlss</span> family object, see <code><a href='family.bamlss.html'>family.bamlss</a></code>.</p></td>
    </tr>
    <tr>
      <th>shuffle</th>
      <td><p>Should observations be shuffled?</p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>A named numeric vector containing possible starting values, the names are based on
    function <code><a href='parameters.html'>parameters</a></code>.</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>Can be used to supply model offsets for use in fitting,
    returned from function <code><a href='bamlss.frame.html'>bamlss.frame</a></code>.</p></td>
    </tr>
    <tr>
      <th>epochs</th>
      <td><p>For how many epochs should the algorithm run?</p></td>
    </tr>
    <tr>
      <th>nbatch</th>
      <td><p>Number of batches. Can also be a number between 0 and 1, i.e., determining
    the fraction of observations that should be used for fitting.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Print information during runtime of the algorithm.</p></td>
    </tr>
    <tr>
      <th>mc.cores</th>
      <td><p>On how many cores should estimation be started?</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>For <code>bbfitp()</code> all arguments to be passed to <code>bbfit()</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The algorithm uses batch-wise estimation of regression coefficients and smoothing variances.
  The smoothing variances are estimated on an hold-out batch. This way, models for very large
  data sets can be estimated. Note, the algorithm can work in combination with the <span class="pkg">ff</span>
  and <span class="pkg">ffbase</span> package, i.e., the entire data is never in the computer RAM. Therefore, the
  data can either to be stored as comma separated file on disc or provided as <code>"ffdf"</code>
  data frame, see also the examples.</p>
<p>The optimizer functions use additional arguments:</p><ul>
<li><p><code>batch_ids</code>. This argument can either be a list of indices specifying the
      batches that should be used for estimation, or a vector of length 2, where the
      first element specifies the number of observations that should be sampled for each
      batch and the second argument specifies the number of batches, see the example.</p></li>
<li><p><code>nu</code>, the step length control parameter. Defaults to <code>nu = 0.05</code>.
      If argument <code>slice = TRUE</code> then <code>nu = 1</code>.</p></li>
<li><p><code>loglik</code>, defaults to <code>loglik = FALSE</code>. If set to <code>loglik = TRUE</code>
      the "out-of-sample" log-likelihood is used for smoothing variance estimation.</p></li>
<li><p><code>aic</code>, defaults to <code>aic = FALSE</code>, If set to <code>aic = TRUE</code>
      the "out-of-sample" AIC is used for smoothing variance estimation.</p></li>
<li><p><code>eps_loglik</code>, defaults to <code>eps_loglik = 0.01</code>. This argument specifies
      the relative change in the "out-of-sample" log-likelihood that is needed such that
      a model term gets updated.</p></li>
<li><p><code>select</code>, defaults to <code>select = FALSE</code>. If set to <code>select = TRUE</code>,
      the algorithm only selects the model term with the largest contribution in the
      "out-of-sample" log-likelihood for updating in each iteration/batch.</p></li>
<li><p><code>always</code>, defaults to <code>always = FALSE</code>. If set to <code>always = TRUE</code>
      no log-likelihood contribution checks will be used and model terms are always updated.</p></li>
<li><p><code>K</code>, defaults to <code>K = 2</code>. This argument controls the penalty on the
      degrees of freedom in the computation of the AIC.</p></li>
<li><p><code>slice</code>, defaults to <code>slice = FALSE</code>. If set to <code>slice = TRUE</code>,
      slice sampling using the "out-of-sample" log-likelihood or AIC is used for smoothing
      variance estimation. Moreover, <code>always = TRUE</code>, <code>eps_loglik = -Inf</code> and
      <code>nu = 1</code>. If <code>slice</code> is an integer <code>n</code>, slice sampling is started after
      <code>n</code> iterations, before smoothing variances are optimized.</p></li>
</ul>
    <p>When using function <code>opt_bbfitp</code>, the parameter updates are stored as <code>"mcmc"</code>
  objects. In this case the traceplots can be visualized using <code><a href='plot.bamlss.html'>plot.bamlss</a></code>.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For function <code>opt_bbfit()</code> a list containing the following objects:</p>
<dt>fitted.values</dt><dd><p>A named list of the fitted values of the modeled parameters
    of the selected distribution.</p></dd>
  <dt>parameters</dt><dd><p>The estimated set regression coefficients and smoothing variances.</p></dd>
  <dt>shuffle</dt><dd><p>Logical</p></dd>
  <dt>runtime</dt><dd><p>The runtime of the algorithm.</p></dd>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='bamlss.html'>bamlss</a></code>, <code><a href='bfit.html'>bfit</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>## Simulate data.</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='GAMart.html'>GAMart</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>27000</span>, <span class='kw'>sd</span> <span class='kw'>=</span> -<span class='fl'>1</span>)

<span class='co'>## Write data to disc.</span>
<span class='no'>tf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempdir</a></span>()
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/write.table'>write.table</a></span>(<span class='no'>d</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/file.path'>file.path</a></span>(<span class='no'>tf</span>, <span class='st'>"d.raw"</span>), <span class='kw'>quote</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>","</span>)

<span class='co'>## Model formula.</span>
<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(
  <span class='no'>num</span> ~ <span class='fu'>s</span>(<span class='no'>x1</span>,<span class='kw'>k</span><span class='kw'>=</span><span class='fl'>40</span>) + <span class='fu'>s</span>(<span class='no'>x2</span>,<span class='kw'>k</span><span class='kw'>=</span><span class='fl'>40</span>) + <span class='fu'>s</span>(<span class='no'>x3</span>,<span class='kw'>k</span><span class='kw'>=</span><span class='fl'>40</span>) + <span class='fu'>te</span>(<span class='no'>lon</span>,<span class='no'>lat</span>,<span class='kw'>k</span><span class='kw'>=</span><span class='fl'>10</span>),
  <span class='no'>sigma</span> ~ <span class='fu'>s</span>(<span class='no'>x1</span>,<span class='kw'>k</span><span class='kw'>=</span><span class='fl'>40</span>) + <span class='fu'>s</span>(<span class='no'>x2</span>,<span class='kw'>k</span><span class='kw'>=</span><span class='fl'>40</span>) + <span class='fu'>s</span>(<span class='no'>x3</span>,<span class='kw'>k</span><span class='kw'>=</span><span class='fl'>40</span>) + <span class='fu'>te</span>(<span class='no'>lon</span>,<span class='no'>lat</span>,<span class='kw'>k</span><span class='kw'>=</span><span class='fl'>10</span>)
)

<span class='co'>## Specify 50 batches with 1000 observations.</span>
<span class='no'>batch_ids</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"nobs"</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='st'>"nbatch"</span> <span class='kw'>=</span> <span class='fl'>50</span>)

<span class='co'>## Note, can also be a list of indices, e.g.</span>
<span class='co'>## batch_ids &lt;- lapply(sample(1:nrow(d), size = 1000))</span>

<span class='co'>## Different flavors:</span>
<span class='co'>## (1) Using out-of-sample aic for smoothing</span>
<span class='co'>##     variance estimation. Update is only accepted</span>
<span class='co'>##     if the "out-of-sample" log-likelihood is</span>
<span class='co'>##     increased.</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>b1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='bamlss.html'>bamlss</a></span>(<span class='no'>f</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>d</span>, <span class='kw'>sampler</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>optimizer</span> <span class='kw'>=</span> <span class='no'>opt_bbfit</span>,
  <span class='kw'>batch_ids</span> <span class='kw'>=</span> <span class='no'>batch_ids</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>aic</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>eps_loglik</span> <span class='kw'>=</span> -<span class='fl'>Inf</span>,
  <span class='kw'>always</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'>## Plot estimated effects.</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/plot'>plot</a></span>(<span class='no'>b1</span>)

<span class='co'>## (2) Same but always update, this mimics the classic SGD.</span>
<span class='co'>##     Note, for prediction only the last iteration is</span>
<span class='co'>##     used in this case. To use more iterations use opt_bbfitp(),</span>
<span class='co'>##     Then iterations are stored as "mcmc" object and we can</span>
<span class='co'>##     predict using the burnin argment, e.g.,</span>
<span class='co'>##     p &lt;- predict(b2, model = "mu", burnin = 35)</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>2</span>)
<span class='no'>b2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='bamlss.html'>bamlss</a></span>(<span class='no'>f</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>d</span>, <span class='kw'>sampler</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>optimizer</span> <span class='kw'>=</span> <span class='no'>opt_bbfit</span>,
  <span class='kw'>batch_ids</span> <span class='kw'>=</span> <span class='no'>batch_ids</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>aic</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>eps_loglik</span> <span class='kw'>=</span> -<span class='fl'>Inf</span>,
  <span class='kw'>always</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>## Plot coefficient paths for x3 in mu.</span>
<span class='fu'><a href='pathplot.html'>pathplot</a></span>(<span class='no'>b2</span>, <span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"mu.s.s(x3).b"</span>)

<span class='co'>## (3) Boosting type flavor, only update model term with</span>
<span class='co'>##     the largest contribution in the "out-of-sample"</span>
<span class='co'>##     log-likelihood. In this case, if edf = 0 during</span>
<span class='co'>##     runtime of the algorithm, no model has an additional</span>
<span class='co'>##     contribution and the algorithm converges. This</span>
<span class='co'>##     behavior is controlled by argument eps_loglik, the</span>
<span class='co'>##     higher eps_loglik, the more restrictive is the</span>
<span class='co'>##     updating step.</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>3</span>)
<span class='no'>b3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='bamlss.html'>bamlss</a></span>(<span class='no'>f</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>d</span>, <span class='kw'>sampler</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>optimizer</span> <span class='kw'>=</span> <span class='no'>opt_bbfit</span>,
    <span class='kw'>batch_ids</span> <span class='kw'>=</span> <span class='no'>batch_ids</span>, <span class='kw'>nu</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>aic</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>eps_loglik</span> <span class='kw'>=</span> <span class='fl'>0.01</span>,
    <span class='kw'>select</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>always</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'>## Plot log-likelihood contributions.</span>
<span class='fu'>contribplot</span>(<span class='no'>b3</span>)

<span class='co'>## Note, prediction uses last iterate.</span>
<span class='no'>p3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/predict'>predict</a></span>(<span class='no'>b3</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>"mu"</span>)

<span class='co'>## (4) Use slice sampling under the "out-of-sample"</span>
<span class='co'>##     log likelihood for estimation of smoothing</span>
<span class='co'>##     variances. In this case model terms are always</span>
<span class='co'>##     updated ad parameter paths behave like a MCMC</span>
<span class='co'>##     chain. Therefore, use opt_bbfitp(), which stores</span>
<span class='co'>##     parameter paths as "mcmc" objects and we can</span>
<span class='co'>##     inspect using traceplots. Note nu = 1 if</span>
<span class='co'>##     slice = TRUE.</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>4</span>)
<span class='no'>b4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='bamlss.html'>bamlss</a></span>(<span class='no'>f</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>d</span>, <span class='kw'>sampler</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>optimizer</span> <span class='kw'>=</span> <span class='no'>opt_bbfitp</span>,
  <span class='kw'>batch_ids</span> <span class='kw'>=</span> <span class='no'>batch_ids</span>, <span class='kw'>aic</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>slice</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/plot'>plot</a></span>(<span class='no'>b4</span>)

<span class='co'>## Plot parameter updates/samples.</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/plot'>plot</a></span>(<span class='no'>b4</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='st'>"samples"</span>)

<span class='co'>## Predict with burnin and compute mean</span>
<span class='co'>## prediction of the last 20 iterates.</span>
<span class='no'>p4</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/predict'>predict</a></span>(<span class='no'>b4</span>, <span class='kw'>model</span> <span class='kw'>=</span> <span class='st'>"mu"</span>, <span class='kw'>burnin</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='no'>mean</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Nikolaus Umlauf, Nadja Klein, Achim Zeileis, Thorsten Simon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

