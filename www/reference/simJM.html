<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate longitudinal and survival data for joint models — simJM • bamlss</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate longitudinal and survival data for joint models — simJM" />
<meta property="og:description" content="Simulates longitudinal data with normal error and (Cox-type) survival times
  using the inversion method. The function simJM() is a wrapper specifying
  all predictors and the resulting data sets. The wrapper calls rJM() to sample
  the survival times, a modified version of rSurvtime() from the R package
  CoxFlexBoost." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bamlss</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bamlss.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/terms.html">Available Model Terms</a>
    </li>
    <li>
      <a href="../articles/families.html">Families</a>
    </li>
    <li>
      <a href="../articles/bf.html">BAMLSS Model Frame</a>
    </li>
    <li>
      <a href="../articles/engines.html">Estimation Engines</a>
    </li>
    <li>
      <a href="../articles/distregvis.html">Visualization with distreg.vis</a>
    </li>
    <li>
      <a href="../articles/glm.html">Generalized Linear Models (+)</a>
    </li>
    <li>
      <a href="../articles/multinomial.html">Bayesian Multinomial Regression</a>
    </li>
    <li>
      <a href="../articles/rent.html">Munich Rent Example</a>
    </li>
    <li>
      <a href="../articles/zn.html">Spatial Location-Scale Model</a>
    </li>
    <li>
      <a href="../articles/misc.html">Miscellaneous Topics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Publications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/jm.html">Bayesian Joint Models for Longitudinal and Survival Data</a>
    </li>
    <li>
      <a href="../articles/bivnorm.html">Bivariate Gaussian Models for Wind Vectors</a>
    </li>
    <li>
      <a href="../articles/cox.html">Complex Space-Time Interactions in a Cox Model</a>
    </li>
    <li>
      <a href="../articles/lasso.html">LASSO-Type Penalization in the Framework of GAMLSS</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate longitudinal and survival data for joint models</h1>
    
    <div class="hidden name"><code>simJM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulates longitudinal data with normal error and (Cox-type) survival times
  using the inversion method. The function <code>simJM()</code> is a wrapper specifying
  all predictors and the resulting data sets. The wrapper calls <code>rJM()</code> to sample
  the survival times, a modified version of <code>rSurvtime()</code> from the <span style="R">R</span> package
  <span class="pkg">CoxFlexBoost</span>.</p>
    </div>

    <pre class="usage"><span class='fu'>simJM</span>(<span class='kw'>nsub</span> <span class='kw'>=</span> <span class='fl'>300</span>, <span class='kw'>times</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq</a></span>(<span class='fl'>0</span>, <span class='fl'>120</span>, <span class='fl'>1</span>), <span class='kw'>probmiss</span> <span class='kw'>=</span> <span class='fl'>0.75</span>,
  <span class='kw'>long_setting</span> <span class='kw'>=</span> <span class='st'>"functional"</span>,
  <span class='kw'>alpha_setting</span> <span class='kw'>=</span> <span class='kw'>if</span>(<span class='no'>nonlinear</span>) <span class='st'>"linear"</span> <span class='kw'>else</span> <span class='st'>"nonlinear"</span>,
  <span class='kw'>dalpha_setting</span> <span class='kw'>=</span> <span class='st'>"zero"</span>, <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='fl'>0.3</span>, <span class='kw'>long_df</span> <span class='kw'>=</span> <span class='fl'>6</span>, <span class='kw'>tmax</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>full</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>nonlinear</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>fac</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>rJM</span>(<span class='no'>hazard</span>, <span class='no'>censoring</span>, <span class='no'>x</span>, <span class='no'>r</span>,
  <span class='kw'>subdivisions</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>tmin</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='no'>tmax</span>,
  <span class='kw'>file</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>nsub</th>
      <td><p>number of individuals for which longitudinal data and survival times should be simulated.</p></td>
    </tr>
    <tr>
      <th>times</th>
      <td><p>vector of time points at which longitudinal measurements are "sampled".</p></td>
    </tr>
    <tr>
      <th>probmiss</th>
      <td><p>proportion of longitudinal measurements to be set to missing. Used to induce
    sparsity in the longitudinal measurements.</p></td>
    </tr>
    <tr>
      <th>long_setting</th>
      <td><p>Specification of the longitudinal trajectories of the sampled subjects.
    Preset specifications are <code>"linear"</code>, <code>"nonlinear"</code> and <code>"functional"</code>. See Details.</p></td>
    </tr>
    <tr>
      <th>alpha_setting</th>
      <td><p>specification of the association between survival and longitudinal. Preset
    specifications are <code>"simple"</code>, <code>"linear"</code>, <code>"nonlinear"</code> and
    <code>"nonlinear2"</code>. See Details.</p></td>
    </tr>
    <tr>
      <th>dalpha_setting</th>
      <td><p>specification of the association between survival and the derivative of the
    longitudinal. Work in progress.</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>standard deviation of the normal error around the true longitudinal measurements.</p></td>
    </tr>
    <tr>
      <th>long_df</th>
      <td><p>number of basis functions from which functional random intercepts are sampled.</p></td>
    </tr>
    <tr>
      <th>tmax</th>
      <td><p>For function <code>simJM()</code>, longest possible survival time, observations are censored
    after that timepoint. Defaults to <code><a href='https://www.rdocumentation.org/packages/base/topics/Extremes'>max(times)</a></code> and should not be specified longer than
    <code><a href='https://www.rdocumentation.org/packages/base/topics/Extremes'>max(times)</a></code> for longitudinal setting "functional". For function <code>rJM()</code>, latest
    time point to sample a survival time.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>numeric scalar setting the random seed.</p></td>
    </tr>
    <tr>
      <th>full</th>
      <td><p>logical indicating if only the longitudinal data set should be returned (<code>FALSE</code>)
    or additionally also the data for the survival part evaluated on a regular time grid and the
    longitudinal data set without longitudinal missings (<code>TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>file</th>
      <td><p>name of the data file the generated data set should be stored into
    (e.g., "simdata.RData") or NULL if the dataset should directly be returned in <span style="R">R</span>.</p></td>
    </tr>
    <tr>
      <th>nonlinear</th>
      <td><p>If set to <code>TRUE</code>, a nonlinear interaction between <code>alpha</code> and
    <code>mu</code> is simulated.</p></td>
    </tr>
    <tr>
      <th>fac</th>
      <td><p>If set to <code>TRUE</code>, a smooth interaction that varies by a factor is simulated.</p></td>
    </tr>
    <tr>
      <th>hazard</th>
      <td><p>complete hazard function to specify the joint model. Time must be the
    first argument.</p></td>
    </tr>
    <tr>
      <th>censoring</th>
      <td><p>function to compute (random) censoring.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>matrix of sampled covariate values.</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>matrix of sampled random coefficients.</p></td>
    </tr>
    <tr>
      <th>subdivisions</th>
      <td><p>the maximum number of subintervals for the integration.</p></td>
    </tr>
    <tr>
      <th>tmin</th>
      <td><p>earliest time point to sample a survival time.</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>further arguments to be passed to <code>hazard</code> or <code>censoring</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function simulates longitudinal data basing on the given specification at given <code>times</code>.
  The full hazard is built from all joint model predictors \(\eta_{\mu}\), \(\eta_{\sigma}\),
  \(\eta_{\lambda}\), \(\eta_{\gamma}\), \(\eta_{\alpha}\) as presented in
  Koehler, Umlauf, and Greven (2016), see also <code><a href='jm_bamlss.html'>jm_bamlss</a></code>. Survival times are sampled using the inversion
  method (cf. Bender, Augustin, &amp; Blettner, 2005). Additional censoring and missingness is
  introduced. The longitudinal information is censored according to the survival information. The
  user can also specify own predictors and use only <code>rJM</code> to simulate survival times
  accordingly.</p>  
<p>Pre-specified functions for \(\eta_{\mu}\) in <code>long_setting</code> are for <code>linear</code>
  $$\eta_{\mu i}(t) = 1.25 + r_{1i} + 0.6 \sin(x_{2i}) + (-0.01) t + 0.02 r_{2i} t$$,
  for <code>nonlinear</code> $$\eta_{\mu i}(t) = 0.5 + r_{1i} + 0.6 \sin(x_{2i}) + 0.1 (t+1) \exp(-0.075 t)$$
  and for <code>functional</code>
  $$\eta_{\mu i}(t) = 0.5 + r_{1i} + 0.6 \sin(x_{2i}) + 0.1 (t+1) \exp(-0.075 t) + \sum_k \beta_{ki} B(t)$$,
  where \(B(.)\) denotes a B-spline basis function and \(\beta_{ki}\) are the sampled penalized
  coefficients from <code>gen_b</code> per person.</p>
<p>Prespecified functions for \(\eta_{\alpha}\) in <code>alpha_setting</code> are for <code>constant</code>
  $$\eta_{\alpha}(t) = 1$$, for <code>linear</code> $$\eta_{\alpha}(t) = 1 - 0.015 t$$, for
  <code>nonlinear</code> $$\eta_{\alpha}(t) = \cos((time-20)/20)$$, and for <code>nonlinear</code>
  $$\eta_{\alpha}(t) = \cos((time-33)/33)$$.</p>
<p>Additionally the fixed functions for \(\eta_{\lambda} = 0.1(t+2)\exp(-0.075t)\) and
  \(\eta_{\lambda} = 0.1(t+2)\exp(-0.075t)\) are employed.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For <code>full = TRUE</code> a list of the three <code>data.frame</code>s is returned:</p>
<dt>data</dt><dd><p>Simulated dataset in long format including all longitudinal and survival covariates.</p></dd>
    <dt>data_grid</dt><dd><p>Dataset of the time-varying survival predictors which are not subject specific,
      evaluated at a grid of fixed time points.</p></dd>
    <dt>data_full</dt><dd><p>Simulated data set prior to generating longitudinal missings. Useful to
      assess the longitudinal fit.</p></dd>
  For full = FALSE only the first dataset is returned. 

  Covariates within these datasets include a subject identifier id, the sampled survival
  times survtime, the event indicator event, the time points of longitudinally
  "observed" measurements  obstime,   the longitudinal response y, the cumulative
  hazard at the survival time cumhaz, as well as covariates  x1, x2, random effects
  r1, r2, b1, ...,  and the true predictors alpha, lambda, gamma, mu, sigma. 

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hofner, B (2016). <span class="pkg">CoxFlexBoost</span>: Boosting Flexible Cox Models
  (with Time-Varying Effects). <span style="R">R</span> package version 0.7-0.</p>
<p>Bender, R., Augustin, T., and Blettner, M. (2005).
  Generating Survival Times to Simulate Cox Proportional Hazards Models.
  <em>Statistics in Medicine</em>, <b>24</b>, 1713-1723.</p>  
<p>Koehler N, Umlauf N, Beyerlein, A., Winkler, C., Ziegler, A., and Greven S (2016). Flexible Bayesian Additive Joint Models with an
    Application to Type 1 Diabetes Research. <em>(submitted)</em></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='jm_bamlss.html'>jm_bamlss</a></code>, <code><a href='jm_bamlss.html'>opt_JM</a></code>, <code><a href='jm_bamlss.html'>sam_JM</a></code>, <code><a href='bamlss.html'>bamlss</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>## Simulate survival data</span>
<span class='co'>## with functional random intercepts and a nonlinear effect </span>
<span class='co'>## of time, time-varying association alpha.</span>
<span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fu'>simJM</span>(<span class='kw'>nsub</span> <span class='kw'>=</span> <span class='fl'>300</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/head'>head</a></span>(<span class='no'>d</span>)

<span class='co'>## Simulate survival data</span>
<span class='co'>## with random intercepts/slopes and a linear effect of time,</span>
<span class='co'>## constant association alpha.</span>
<span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fu'>simJM</span>(<span class='kw'>nsub</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>long_setting</span> <span class='kw'>=</span> <span class='st'>"linear"</span>,
  <span class='kw'>alpha_setting</span> <span class='kw'>=</span> <span class='st'>"constant"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/head'>head</a></span>(<span class='no'>d</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Nikolaus Umlauf, Nadja Klein, Achim Zeileis, Thorsten Simon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

