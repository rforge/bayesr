<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BAMLSS Families • bamlss</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BAMLSS Families">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bamlss</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bamlss.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/terms.html">Available Model Terms</a>
    </li>
    <li>
      <a href="../articles/families.html">Families</a>
    </li>
    <li>
      <a href="../articles/bf.html">BAMLSS Model Frame</a>
    </li>
    <li>
      <a href="../articles/engines.html">Estimation Engines</a>
    </li>
    <li>
      <a href="../articles/distregvis.html">Visualization with distreg.vis</a>
    </li>
    <li>
      <a href="../articles/glm.html">Generalized Linear Models (+)</a>
    </li>
    <li>
      <a href="../articles/multinomial.html">Bayesian Multinomial Regression</a>
    </li>
    <li>
      <a href="../articles/rent.html">Munich Rent Example</a>
    </li>
    <li>
      <a href="../articles/zn.html">Spatial Location-Scale Model</a>
    </li>
    <li>
      <a href="../articles/misc.html">Miscellaneous Topics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Publications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/jm.html">Bayesian Joint Models for Longitudinal and Survival Data</a>
    </li>
    <li>
      <a href="../articles/bivnorm.html">Bivariate Gaussian Models for Wind Vectors</a>
    </li>
    <li>
      <a href="../articles/cox.html">Complex Space-Time Interactions in a Cox Model</a>
    </li>
    <li>
      <a href="../articles/lasso.html">LASSO-Type Penalization in the Framework of GAMLSS</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>BAMLSS Families</h1>
            
      
      
      <div class="hidden name"><code>families.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>Family objects are important building blocks in the design of BAMLSS models. They specify the distribution by collecting functions of the density, respective log-likelihood, first-order derivatives of the log-likelihood w.r.t. predictors (the score function), and (optionally) second-order derivatives of the log-likelihood w.r.t. predictors <em>or</em> their expectation (the Hessian).</p>
<p>The <em>bamlss</em> package can be easily extended by <a href="#build">constructing families</a> for specific tasks, i.e. problems for which a likelihood can be formulated. However, the most important distributions are <a href="#avail">shipped with <em>bamlss</em></a>. Finally, it is also possible to employ <a href="#gamlss"><em>gamlss</em> families</a>.</p>
</div>
<div id="build" class="section level2">
<h2 class="hasAnchor">
<a href="#build" class="anchor"></a>How to build a <em>bamlss</em> family</h2>
<p>We illustrate how to build a <em>bamlss</em> family <em>by hand</em> along the Gaussian distribution, with density <span class="math display">\[
f(y\,|\,\mu,\sigma) = \frac{1}{\sqrt{2\pi}\sigma} \cdot \exp
\left( \frac{-(y-\mu)^2}{2\sigma^2} \right),
\]</span> and log-likelihood function <span class="math display">\[
\ell(\mu,\sigma\,|\,y) = - \frac{1}{2} \log(2\pi) - \log(\sigma) -
\frac{(y-\mu)^2}{2\sigma^2},
\]</span> for an individual observation. The sum of the log-likelihood function over all observations is the target function of the optimization problem.</p>
<p>In the distributional regression framework the parameters are linked to predictors by link functions, <span class="math display">\[
\mu = \eta_\mu, \qquad \log(\sigma) = \eta_\sigma.
\]</span> For the Gaussian <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are linked to <span class="math inline">\(\eta_\mu\)</span> and <span class="math inline">\(\eta_\sigma\)</span> by the identity function and the logarithm, respectively.</p>
<p>The score functions in <em>bamlss</em> are the first derivatives of the log-likelihood w.r.t. the predictors: <span class="math display">\[
s_\mu = \frac{\partial\ell}{\partial\eta_\mu} = \frac{\partial\ell}{\partial\mu} \cdot
\frac{\partial\mu}{\partial\eta_\mu} = \frac{y-\mu}{\sigma^2},
\]</span> and <span class="math display">\[
s_\sigma = \frac{\partial\ell}{\partial\eta_\sigma} = \frac{\partial\ell}{\partial\sigma} \cdot
\frac{\partial\sigma}{\partial\eta_\sigma} = -1 + \frac{(y-\mu)^2}{\sigma^2}.
\]</span></p>
<p>For the second derivative of the log-likelihood we are able to obtain the negative expectation, <span class="math display">\[
\mathsf{E}(-\partial^2\ell / \partial\eta_{\mu}^{2} ) = \sigma^{-2},
\]</span> and <span class="math display">\[
\mathsf{E}(-\partial^2\ell / \partial\eta_{\sigma}^{2} ) = 2.
\]</span></p>
<p>Now we have to write a function that returns a <code>family.bamlss</code> object (S3) which encapsulates functions for density, score and Hessian, and the names of the family, parameter and link functions:</p>
<table class="table">
<colgroup>
<col width="21%">
<col width="78%">
</colgroup>
<thead><tr class="header">
<th>Name of element</th>
<th>Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>family</code></td>
<td>character string with the name of the family</td>
</tr>
<tr class="even">
<td><code>names</code></td>
<td>vector of character strings with the names of the parameters</td>
</tr>
<tr class="odd">
<td><code>links</code></td>
<td>vector of character strings with the names of the link functions</td>
</tr>
<tr class="even">
<td><code>d</code></td>
<td>a function returning the density with arguments <code>y, par, log = FALSE</code> (see below)</td>
</tr>
<tr class="odd">
<td><code>score</code></td>
<td>a list with functions (one for each parameter) returning the first derivatives of the log-likelihood w.r.t. predictors</td>
</tr>
<tr class="even">
<td><code>hess</code></td>
<td>a list with functions (one for each parameter) returning the negative second derivatives of the log-likelihood w.r.t. predictors</td>
</tr>
</tbody>
</table>
<p>Nearly all functions take as first argument the response <code>y</code> and as second argument a named list holding the evaluated parameters <code>par</code> of the distribution on the scale of the predictors <span class="math inline">\(\eta_{\star}\)</span>.</p>
<p>The implementation looks like this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">mygauss &lt;-<span class="st"> </span><span class="cf">function</span>(...) {</a>
<a class="sourceLine" id="cb1-2" title="2">    f &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb1-3" title="3">        <span class="st">"family"</span> =<span class="st"> "mygauss"</span>,</a>
<a class="sourceLine" id="cb1-4" title="4">        <span class="st">"names"</span>  =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"mu"</span>, <span class="st">"sigma"</span>),</a>
<a class="sourceLine" id="cb1-5" title="5">        <span class="st">"links"</span>  =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">mu =</span> <span class="st">"identity"</span>, <span class="dt">sigma =</span> <span class="st">"log"</span>),</a>
<a class="sourceLine" id="cb1-6" title="6">        <span class="st">"d"</span> =<span class="st"> </span><span class="cf">function</span>(y, par, <span class="dt">log =</span> <span class="ot">FALSE</span>) {</a>
<a class="sourceLine" id="cb1-7" title="7">            <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">dnorm</a></span>(y, <span class="dt">mean =</span> par<span class="op">$</span>mu, <span class="dt">sd =</span> par<span class="op">$</span>sigma, <span class="dt">log =</span> log)</a>
<a class="sourceLine" id="cb1-8" title="8">        },</a>
<a class="sourceLine" id="cb1-9" title="9">        <span class="st">"score"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb1-10" title="10">            <span class="dt">mu =</span> <span class="cf">function</span>(y, par, ...) {</a>
<a class="sourceLine" id="cb1-11" title="11">                <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/drop">drop</a></span>((y <span class="op">-</span><span class="st"> </span>par<span class="op">$</span>mu) <span class="op">/</span><span class="st"> </span>(par<span class="op">$</span>sigma<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1-12" title="12">            },</a>
<a class="sourceLine" id="cb1-13" title="13">            <span class="dt">sigma =</span> <span class="cf">function</span>(y, par, ...) {</a>
<a class="sourceLine" id="cb1-14" title="14">                <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/drop">drop</a></span>(<span class="op">-</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(y <span class="op">-</span><span class="st"> </span>par<span class="op">$</span>mu)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(par<span class="op">$</span>sigma<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1-15" title="15">            }</a>
<a class="sourceLine" id="cb1-16" title="16">        ),</a>
<a class="sourceLine" id="cb1-17" title="17">        <span class="st">"hess"</span> =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb1-18" title="18">            <span class="dt">mu =</span> <span class="cf">function</span>(y, par, ...) {</a>
<a class="sourceLine" id="cb1-19" title="19">                <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/drop">drop</a></span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(par<span class="op">$</span>sigma<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1-20" title="20">            },</a>
<a class="sourceLine" id="cb1-21" title="21">            <span class="dt">sigma =</span> <span class="cf">function</span>(y, par, ...) { </a>
<a class="sourceLine" id="cb1-22" title="22">                <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">2</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(y))</a>
<a class="sourceLine" id="cb1-23" title="23">            }</a>
<a class="sourceLine" id="cb1-24" title="24">        )</a>
<a class="sourceLine" id="cb1-25" title="25">    )</a>
<a class="sourceLine" id="cb1-26" title="26">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(f) &lt;-<span class="st"> "family.bamlss"</span></a>
<a class="sourceLine" id="cb1-27" title="27">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(f)</a>
<a class="sourceLine" id="cb1-28" title="28">}</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"bamlss"</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">## Simulate some data.</span></a>
<a class="sourceLine" id="cb2-4" title="4">d &lt;-<span class="st"> </span><span class="kw"><a href="../reference/GAMart.html">GAMart</a></span>()</a>
<a class="sourceLine" id="cb2-5" title="5"></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">## Specify formula.</span></a>
<a class="sourceLine" id="cb2-7" title="7">f &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">s</span>(x1) <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(x2) <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(x3) <span class="op">+</span><span class="st"> </span><span class="kw">s</span>(lon, lat)</a>
<a class="sourceLine" id="cb2-8" title="8">f &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">mu =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/update">update</a></span>(f, num <span class="op">~</span><span class="st"> </span>.), <span class="dt">sigma =</span> f)</a>
<a class="sourceLine" id="cb2-9" title="9"></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">## Model.</span></a>
<a class="sourceLine" id="cb2-11" title="11">b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bamlss.html">bamlss</a></span>(f, <span class="dt">data =</span> d, <span class="dt">family =</span> mygauss)</a></code></pre></div>
<p>Optionally, the <code>family.bamlss</code> object can be extended by functions for</p>
<ul>
<li>the cumulative distribution function <code>p(y, par, ...)</code>,</li>
<li>the quantile function (the inverse cdf) <code><a href="https://www.rdocumentation.org/packages/base/topics/quit">q(p, par)</a></code>,</li>
<li>a random number generator <code>r(n, par)</code>,</li>
<li>the log-likelihood <code>loglik(y, par)</code>,</li>
<li>the expectation <code>mu(par, ...)</code>,</li>
<li>initial values for optimization, which has to be a list containing a function for each parameter,</li>
<li>…</li>
</ul>
<p>which can help to speed up optimization, or be convenient for predictions and simulations.</p>
</div>
<div id="avail" class="section level2">
<h2 class="hasAnchor">
<a href="#avail" class="anchor"></a>Available families</h2>
<p>There are some families implemented:</p>
<div id="continuous-response" class="section level3">
<h3 class="hasAnchor">
<a href="#continuous-response" class="anchor"></a>Continuous response</h3>
<div id="gaussian-distribution" class="section level4">
<h4 class="hasAnchor">
<a href="#gaussian-distribution" class="anchor"></a>Gaussian distribution</h4>
<p>Or normal distribution.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\sigma) = \frac{1}{\sqrt{2\pi}\sigma} \cdot \exp
\left( \frac{-(y-\mu)^2}{2\sigma^2} \right),
\]</span> with <span class="math inline">\(\sigma &gt; 0\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mu = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\sigma) = \eta_\sigma\)</span></li>
</ul>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">gaussian_bamlss(...)</a></code></p>
<p><strong>Alternative parameterizations</strong>:</p>
<ul>
<li>
<code><a href="../reference/family.bamlss.html">gaussian2_bamlss(...)</a></code> models inverse <code>sigma</code> with a log link.</li>
<li>
<code><a href="../reference/family.bamlss.html">Gaussian_bamlss(...)</a></code> one parametric family modelling only <code>mu</code>.</li>
</ul>
</div>
<div id="generalized-logistic-distribution" class="section level4">
<h4 class="hasAnchor">
<a href="#generalized-logistic-distribution" class="anchor"></a>Generalized logistic distribution</h4>
<p>Or skewed-logistic distribution.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\sigma,\alpha)=\frac{\alpha\cdot\exp\left(-\frac{y-\mu}{\sigma}\right)}
{\sigma\cdot\left(1+\exp\left(-\frac{y-\mu}{\sigma}\right)\right)^{2\alpha}},
\]</span> with <span class="math inline">\(\sigma, \alpha &gt; 0\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mu = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\sigma) = \eta_\sigma\)</span></li>
<li><span class="math inline">\(\log(\alpha) = \eta_\alpha\)</span></li>
</ul>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">glogis_bamlss(...)</a></code></p>
</div>
</div>
<div id="positive-continuous-response" class="section level3">
<h3 class="hasAnchor">
<a href="#positive-continuous-response" class="anchor"></a>Positive continuous response</h3>
<div id="gamma-distribution" class="section level4">
<h4 class="hasAnchor">
<a href="#gamma-distribution" class="anchor"></a>Gamma distribution</h4>
<p>Two-parameter distribution with <span class="math inline">\(\mu &gt; 0\)</span> for the expectation of the distribution and <span class="math inline">\(\sigma &gt; 0\)</span> for its shape.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\sigma)=\frac{y^{\sigma-1}\cdot\exp\left(-\frac{\sigma\cdot y}{\mu}\right)}
{\left(\frac{\mu}{\sigma}\right)^\sigma\cdot\Gamma(\sigma)}.
\]</span></p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\mu) = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\sigma) = \eta_\sigma\)</span></li>
</ul>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">gamma_bamlss(...)</a></code></p>
</div>
<div id="generalized-pareto-distribution" class="section level4">
<h4 class="hasAnchor">
<a href="#generalized-pareto-distribution" class="anchor"></a>Generalized Pareto distribution</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\xi,\sigma)=\frac{1}{\sigma}\cdot\left(1+\frac{\xi\cdot y}{\sigma}
\right)^{-\left(1+1/\xi\right)},
\]</span> with <span class="math inline">\(\xi, \sigma &gt; 0\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\xi) = \eta_\xi\)</span></li>
<li><span class="math inline">\(\log(\sigma) = \eta_\sigma\)</span></li>
</ul>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">gpareto_bamlss(...)</a></code></p>
</div>
<div id="weibull-distribution" class="section level4">
<h4 class="hasAnchor">
<a href="#weibull-distribution" class="anchor"></a>Weibull distribution</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\lambda,\alpha)=\frac{\alpha}{\lambda}\cdot\left(\frac{y}{\lambda}\right)^{\alpha-1}
\cdot\exp\left(-\left(\frac{y}{\lambda}\right)^\alpha\right),
\]</span> with <span class="math inline">\(\lambda, \alpha &gt; 0\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\lambda) = \eta_\lambda\)</span></li>
<li><span class="math inline">\(\log(\alpha) = \eta_\alpha\)</span></li>
</ul>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">weibull_bamlss(...)</a></code></p>
</div>
<div id="lognormal-distribution" class="section level4">
<h4 class="hasAnchor">
<a href="#lognormal-distribution" class="anchor"></a>Lognormal distribution</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\sigma) = \frac{1}{\sqrt{2\pi}\sigma} \cdot \exp
\left( \frac{-(\log(y)-\mu)^2}{2\sigma^2} \right),
\]</span> with <span class="math inline">\(\sigma &gt; 0\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mu = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\sigma) = \eta_\sigma\)</span></li>
</ul>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">lognormal_bamlss(...)</a></code></p>
</div>
</div>
<div id="censored-continuous-responses" class="section level3">
<h3 class="hasAnchor">
<a href="#censored-continuous-responses" class="anchor"></a>Censored continuous responses</h3>
<div id="zero-censored-normal-distribution" class="section level4">
<h4 class="hasAnchor">
<a href="#zero-censored-normal-distribution" class="anchor"></a>Zero-censored normal distribution</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\sigma)= \begin{cases} 
  \frac{1}{\sigma} \phi\left(\frac{y-\mu}{\sigma} \right) &amp; y &gt; 0 \\
  \Phi\left(\frac{-\mu}{\sigma} \right) &amp; \mbox{else,}
\end{cases}
\]</span> where <span class="math inline">\(\phi\)</span> is the probability density and <span class="math inline">\(\Phi\)</span> the cumulative distribution function of the standard normal distribution.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mu = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\sigma) = \eta_\sigma\)</span></li>
</ul>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">cnorm_bamlss(...)</a></code></p>
</div>
</div>
<div id="interval-responses" class="section level3">
<h3 class="hasAnchor">
<a href="#interval-responses" class="anchor"></a>Interval responses</h3>
<div id="beta-distribution" class="section level4">
<h4 class="hasAnchor">
<a href="#beta-distribution" class="anchor"></a>Beta distribution</h4>
<p>The beta distribution, with density <span class="math display">\[
f_{Beta}(y\,|\,\alpha,\beta)=\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\cdot\Gamma(\beta)}
\cdot y^{\alpha-1} \cdot (1-y)^{\beta-1}
\]</span> is implemented using the Balding-Nichols parameterization <span class="citation">(Balding and Nichols 1995)</span>.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\sigma)=f_{Beta}\left(y\,\middle|\,\alpha = \mu \cdot \frac{1-\sigma}{\sigma},
\beta = (1-\mu) \cdot \frac{1-\sigma}{\sigma} \right),
\]</span> with <span class="math inline">\(0 &lt; \mu &lt; 1\)</span> and <span class="math inline">\(0 &lt; \sigma &lt; 1\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mathrm{logit}(\mu)=\eta_\mu\)</span></li>
<li><span class="math inline">\(\mathrm{logit}(\sigma)=\eta_\sigma\)</span></li>
</ul>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">beta_bamlss(...)</a></code></p>
</div>
</div>
<div id="discrete-responses" class="section level3">
<h3 class="hasAnchor">
<a href="#discrete-responses" class="anchor"></a>Discrete responses</h3>
<div id="bernoulli-distribution" class="section level4">
<h4 class="hasAnchor">
<a href="#bernoulli-distribution" class="anchor"></a>Bernoulli distribution</h4>
<p>Often called <em>binomial</em>, though the Bernoulli is a special case of the binomial distribution.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\pi) = \pi^y \cdot (1-\pi)^{1-y},
\]</span> where <span class="math inline">\(\pi\)</span> is a probability.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mathrm{logit}(\pi)=\eta_\pi\)</span></li>
</ul>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">binomial_bamlss(link = "logit", ...)</a></code></p>
</div>
<div id="multinomial-model" class="section level4">
<h4 class="hasAnchor">
<a href="#multinomial-model" class="anchor"></a>Multinomial model</h4>
<p>Say, <span class="math inline">\(y\)</span> is a categorial response with <span class="math inline">\(c+1\)</span> nomial categories, and <span class="math inline">\(y_{1}^{\star}, \dots, y_{c+1}^{\star}\)</span> are associated dummy variables. <span class="math inline">\(p_1, \dots, p_{c+1}\)</span> are probabilities for an observation falling in one of the categories. Category <span class="math inline">\(c+1\)</span> serves as reference, i.e. <span class="math inline">\(p_{c+1} = 1 - p_1 - \dots - p_{c}\)</span>.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\pi_1,\dots,\pi_c) = \prod_{s=1}^{c+1} p_{s}^{y_{s}^{\star}}, \quad
\text{where} \quad p_r = \frac{\pi_r}{1 + \pi_1 + \dots + \pi_c},
\]</span></p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\pi_r) = \log\left(\frac{p_r}{p_{c+1}}\right) = \eta_r,\)</span></li>
</ul>
<p>where <span class="math inline">\(\eta_r\)</span> specifies the log-odds between category <span class="math inline">\(r\)</span> and the reference category <span class="math inline">\(c+1\)</span>.</p>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">multinomial_bamlss(...)</a></code></p>
</div>
</div>
<div id="count-data-responses" class="section level3">
<h3 class="hasAnchor">
<a href="#count-data-responses" class="anchor"></a>Count data responses</h3>
<div id="poisson-distribution" class="section level4">
<h4 class="hasAnchor">
<a href="#poisson-distribution" class="anchor"></a>Poisson distribution</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\lambda) = \frac{\lambda^y \cdot \exp(-\lambda)}{y!},
\]</span> with <span class="math inline">\(\lambda &gt; 0\)</span>.</p>
<p><strong>Link</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\lambda) = \eta_\lambda\)</span></li>
</ul>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">poisson_bamlss(...)</a></code></p>
</div>
<div id="negative-binomial-type-ii" class="section level4">
<h4 class="hasAnchor">
<a href="#negative-binomial-type-ii" class="anchor"></a>Negative binomial (type II)</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\, |\, \mu, \theta) =
\frac{\Gamma(\theta + y)}{\Gamma({\theta}) \cdot y!} \cdot
\frac{\mu^y \cdot \theta^\theta}{(\mu + \theta)^{\theta + y}},
\]</span> with <span class="math inline">\(\mu,\theta &gt; 0\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\mu) = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\theta) = \eta_\theta\)</span></li>
</ul>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">nbinom_bamlss(...)</a></code></p>
</div>
<div id="zero-truncated-negative-binomial" class="section level4">
<h4 class="hasAnchor">
<a href="#zero-truncated-negative-binomial" class="anchor"></a>Zero-truncated negative binomial</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\theta)=\frac{f_{\mathrm{NB}}(y\,|\,\mu,\theta)}
{1-f_{\mathrm{NB}}(0\,|\,\mu,\theta)},
\]</span> where <span class="math inline">\(f_{\mathrm{NB}}\)</span> is the density of the negative binomial.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\mu) = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\theta) = \eta_\theta\)</span></li>
</ul>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">ztnbinom_bamlss(...)</a></code></p>
</div>
</div>
<div id="multivariate-responses" class="section level3">
<h3 class="hasAnchor">
<a href="#multivariate-responses" class="anchor"></a>Multivariate responses</h3>
<div id="multivariate-normal-distribution" class="section level4">
<h4 class="hasAnchor">
<a href="#multivariate-normal-distribution" class="anchor"></a>Multivariate normal distribution</h4>
<p>Say <span class="math inline">\(y\)</span> is a <span class="math inline">\(k\)</span> dimensional observation.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\Sigma) = \frac{1}{\sqrt{(2\pi)^{k} |\Sigma|}} \cdot
\exp \left(-\frac{1}{2} (y-\mu)^\top \Sigma^{-1} (y-\mu) \right),
\]</span> where <span class="math inline">\(\Sigma\)</span> can be decomposed into <span class="math inline">\(\Sigma = D \Omega D\)</span> with <span class="math display">\[
D=
 \begin{pmatrix}
  \sigma_1 &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; \sigma_2 &amp; \cdots &amp; 0 \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  0 &amp; 0 &amp; \cdots &amp; \sigma_k
 \end{pmatrix},
 \qquad \text{and} \qquad
\Omega=
 \begin{pmatrix}
  1 &amp; \rho_{12} &amp; \cdots &amp; \rho_{1k} \\
  \rho_{12} &amp; 1 &amp; \cdots &amp; \rho_{2k} \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  \rho_{1k} &amp; \rho_{2k} &amp; \cdots &amp; 1
 \end{pmatrix}.
\]</span></p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mu_j = \eta_{\mu_j}\)</span></li>
<li><span class="math inline">\(\log(\sigma_j) = \eta_{\sigma_j}\)</span></li>
<li><span class="math inline">\(\mathrm{rhogit}(\rho_{jl}) = \eta_{\rho_{jl}}\)</span></li>
</ul>
<p><strong>Function</strong>: <code><a href="../reference/family.bamlss.html">mvnorm_bamlss(k = 2, ...)</a></code></p>
<p><strong>Alternative parameterizations</strong>:</p>
<ul>
<li>
<code><a href="../reference/family.bamlss.html">mvnormAR1_bamlss(k = 2, ...)</a></code> with <span class="math display">\[
\Omega=
 \begin{pmatrix}
1 &amp; \rho &amp; \rho^2 &amp; \cdots &amp; \rho^{k-1} \\
\rho &amp; 1 &amp; \rho &amp; \cdots &amp; \rho^{k-2} \\
\rho^2 &amp; \rho &amp; 1 &amp; \cdots &amp; \rho^{k-3} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\rho^{k-1} &amp; \rho^{k-2} &amp; \rho^{k-3} &amp; \cdots &amp; 1
 \end{pmatrix},
\]</span> and <span class="math inline">\(\mathrm{rhogit}(\rho) = \eta_{\rho}\)</span>.</li>
</ul>
</div>
</div>
<div id="survival" class="section level3">
<h3 class="hasAnchor">
<a href="#survival" class="anchor"></a>Survival</h3>
<ul>
<li><code><a href="../reference/family.bamlss.html">cox_bamlss(...)</a></code></li>
</ul>
</div>
<div id="others" class="section level3">
<h3 class="hasAnchor">
<a href="#others" class="anchor"></a>Others</h3>
<ul>
<li><code><a href="../reference/family.bamlss.html">AR1_bamlss(ar.start = NULL, ...)</a></code></li>
<li><code><a href="../reference/family.bamlss.html">beta1_bamlss(ar.start, ...)</a></code></li>
</ul>
</div>
</div>
<div id="gamlss" class="section level2">
<h2 class="hasAnchor">
<a href="#gamlss" class="anchor"></a>R package <em>gamlss</em> support</h2>
<p>The <em>bamlss</em> package supports <a href="https://cran.r-project.org/package=gamlss.dist" title="CRAN gamlss.dist"><em>gamlss</em> families</a> via a transfer function that builds the <code>bamlss.family</code> object from a GAMLSS distribution funciton <span class="citation">(Stasinopoulos and Rigby 2007)</span>, e.g. <code><a href="https://www.rdocumentation.org/packages/gamlss.dist/topics/NO">NO()</a></code>, internally:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co">## Load the gamlss families.</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"gamlss.dist"</span>)</a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">## Estimate model.</span></a>
<a class="sourceLine" id="cb3-5" title="5">b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bamlss.html">bamlss</a></span>(f, <span class="dt">data =</span> d, <span class="dt">family =</span> NO)</a></code></pre></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-bamlss:Balding+Nichols:1995">
<p>Balding, David J., and Richard A. Nichols. 1995. “A Method for Quantifying Differentiation Between Populations at Multi-Allelic Loci and Its Implications for Investigating Identity and Paternity.” <em>Genetica</em> 96 (1): 3–12. <a href="https://doi.org/10.1007/BF01441146" class="uri">https://doi.org/10.1007/BF01441146</a>.</p>
</div>
<div id="ref-bamlss:Stasinopoulos:Rigby:2007">
<p>Stasinopoulos, D. Mikis, and Robert A. Rigby. 2007. “Generalized Additive Models for Location Scale and Shape (Gamlss) in R.” <em>Journal of Statistical Software</em> 23 (7): 1–46. <a href="https://doi.org/10.18637/jss.v023.i07" class="uri">https://doi.org/10.18637/jss.v023.i07</a>.</p>
</div>
<div id="ref-bamlss:Umlauf+bamlss:2018">
<p>Umlauf, Nikolaus, Nadja Klein, Achim Zeileis, and Thorsten Simon. 2019. <em>bamlss: Bayesian Additive Models for Location Scale and Shape (and Beyond)</em>. <a href="https://CRAN.R-project.org/package=bamlss" class="uri">https://CRAN.R-project.org/package=bamlss</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#overview">Overview</a></li>
      <li><a href="#build">How to build a <em>bamlss</em> family</a></li>
      <li><a href="#avail">Available families</a></li>
      <li><a href="#gamlss">R package <em>gamlss</em> support</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nikolaus Umlauf, Nadja Klein, Achim Zeileis, Thorsten Simon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
